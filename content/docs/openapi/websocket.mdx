---
title: WebSocket API
description: Real-time data access using WebSockets
---

# WebSocket API

Wind Network provides a WebSocket API for real-time access to blockchain data. This allows you to subscribe to updates about specific accounts, transactions, or blocks as they happen.

## WebSocket Endpoint

```
wss://api.wind.network/v1/ws
```

## Authentication

Authentication is required for WebSocket connections. You can authenticate using either an API key or a JWT token:

### API Key Authentication

```javascript
// Connect with API key
const socket = new WebSocket('wss://api.wind.network/v1/ws');

// After connection opens, send authentication message
socket.onopen = () => {
  socket.send(JSON.stringify({
    type: 'auth',
    method: 'apikey',
    apikey: 'your_api_key_here'
  }));
};
```

### JWT Authentication

```javascript
// Connect with JWT token
const socket = new WebSocket('wss://api.wind.network/v1/ws');

// After connection opens, send authentication message
socket.onopen = () => {
  socket.send(JSON.stringify({
    type: 'auth',
    method: 'jwt',
    token: 'your_jwt_token_here'
  }));
};
```

## Subscription Types

The WebSocket API supports several subscription types:

### Account Updates

Subscribe to updates for a specific account:

```javascript
socket.send(JSON.stringify({
  type: 'subscribe',
  subscription: 'account',
  address: 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA',
  commitment: 'finalized'  // Optional, default is 'finalized'
}));
```

Response format for account updates:

```json
{
  "type": "account",
  "subscription_id": "acc_123456",
  "data": {
    "address": "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",
    "lamports": 10290815,
    "owner": "BPFLoaderUpgradeab1e11111111111111111111111",
    "executable": true,
    "rent_epoch": 327,
    "data": "...",
    "data_base64": "...",
    "updated_at": "2023-05-15T14:32:10Z"
  }
}
```

### Program Accounts

Subscribe to updates for all accounts owned by a specific program:

```javascript
socket.send(JSON.stringify({
  type: 'subscribe',
  subscription: 'program',
  program_id: 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA',
  commitment: 'confirmed'  // Optional, default is 'finalized'
}));
```

Response format for program account updates:

```json
{
  "type": "program",
  "subscription_id": "prog_123456",
  "data": {
    "address": "8VRnd8ioFKpNpBznCEFd6uiT55P4Zy1XgF6Jj8Efc7vY",
    "lamports": 5000000,
    "owner": "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",
    "executable": false,
    "rent_epoch": 327,
    "data": "...",
    "data_base64": "...",
    "parsed_data": {
      // Program-specific parsed data if available
    },
    "updated_at": "2023-05-15T14:32:10Z"
  }
}
```

### Transaction Confirmation

Subscribe to updates for a specific transaction:

```javascript
socket.send(JSON.stringify({
  type: 'subscribe',
  subscription: 'transaction',
  signature: '5UfgccMvubS3mYjvWgwEy6ewQQRXDFy66WcGtrNeuGXrr9ATYfkP8adKsVvofNViqoYmGcNQ4hdCTjdLQZXS69ve'
}));
```

Response format for transaction updates:

```json
{
  "type": "transaction",
  "subscription_id": "tx_123456",
  "data": {
    "signature": "5UfgccMvubS3mYjvWgwEy6ewQQRXDFy66WcGtrNeuGXrr9ATYfkP8adKsVvofNViqoYmGcNQ4hdCTjdLQZXS69ve",
    "slot": 172868170,
    "confirmations": 5,
    "err": null,
    "status": "confirmed"
  }
}
```

### New Blocks

Subscribe to notifications about new blocks:

```javascript
socket.send(JSON.stringify({
  type: 'subscribe',
  subscription: 'blocks',
  commitment: 'finalized'  // Optional, default is 'finalized'
}));
```

Response format for new blocks:

```json
{
  "type": "block",
  "subscription_id": "block_123456",
  "data": {
    "slot": 172868170,
    "block_height": 148325230,
    "block_time": 1684160530,
    "block_hash": "CQtTtrNh1xYZX5qLyGvNUAjgKzaS5YTTFNgYJcJ4YvLP",
    "parent_block_hash": "AhL6zNaJnFZCwNyJffg7GNbxRbcf2WwJrQuL9SVaUMpp",
    "transaction_count": 5432
  }
}
```

### Logs

Subscribe to log messages from a specific program:

```javascript
socket.send(JSON.stringify({
  type: 'subscribe',
  subscription: 'logs',
  program_id: 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA',
  commitment: 'confirmed'  // Optional, default is 'finalized'
}));
```

Response format for log messages:

```json
{
  "type": "logs",
  "subscription_id": "logs_123456",
  "data": {
    "signature": "5UfgccMvubS3mYjvWgwEy6ewQQRXDFy66WcGtrNeuGXrr9ATYfkP8adKsVvofNViqoYmGcNQ4hdCTjdLQZXS69ve",
    "slot": 172868170,
    "logs": [
      "Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA invoke [1]",
      "Program log: Instruction: Transfer",
      "Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA success"
    ]
  }
}
```

## Unsubscribing

To unsubscribe from a specific subscription:

```javascript
socket.send(JSON.stringify({
  type: 'unsubscribe',
  subscription_id: 'acc_123456'  // The subscription ID returned from the subscribe response
}));
```

## Heartbeat

The WebSocket server sends heartbeat messages every 30 seconds to keep the connection alive:

```json
{
  "type": "heartbeat",
  "timestamp": 1684160530
}
```

Clients should respond to heartbeat messages to maintain the connection:

```javascript
socket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  
  if (data.type === 'heartbeat') {
    socket.send(JSON.stringify({
      type: 'heartbeat',
      timestamp: data.timestamp
    }));
  }
  
  // Handle other message types...
};
```

## Error Handling

If an error occurs, the server will send an error message:

```json
{
  "type": "error",
  "code": 1002,
  "message": "Invalid subscription parameters"
}
```

Common error codes:

| Code | Description |
|------|-------------|
| 1001 | Authentication failed |
| 1002 | Invalid subscription parameters |
| 1003 | Rate limit exceeded |
| 1004 | Subscription not found |
| 1005 | Internal server error |

## Example: Full WebSocket Client

Here's a complete example of a WebSocket client in JavaScript:

```javascript
// Connect to WebSocket
const socket = new WebSocket('wss://api.wind.network/v1/ws');

socket.onopen = () => {
  console.log('Connected to Wind Network WebSocket API');
  
  // Authenticate
  socket.send(JSON.stringify({
    type: 'auth',
    method: 'apikey',
    apikey: 'your_api_key_here'
  }));
  
  // Subscribe to an account after successful authentication
  setTimeout(() => {
    socket.send(JSON.stringify({
      type: 'subscribe',
      subscription: 'account',
      address: 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA'
    }));
  }, 1000);
};

socket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  
  switch (data.type) {
    case 'auth':
      console.log('Authentication result:', data.status);
      break;
      
    case 'heartbeat':
      socket.send(JSON.stringify({
        type: 'heartbeat',
        timestamp: data.timestamp
      }));
      break;
      
    case 'account':
      console.log('Account update:', data.data);
      break;
      
    case 'error':
      console.error('Error:', data.message);
      break;
      
    default:
      console.log('Received:', data);
  }
};

socket.onerror = (error) => {
  console.error('WebSocket error:', error);
};

socket.onclose = (event) => {
  console.log('Disconnected from Wind Network WebSocket API:', event.code, event.reason);
};
``` 